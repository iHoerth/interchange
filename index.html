<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .task-form {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .task-input {
            width: 70%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 1em;
            margin-right: 10px;
            transition: border-color 0.3s ease;
        }

        .task-input:focus {
            outline: none;
            border-color: #3498db;
        }

        .add-btn {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }

        .add-btn:hover {
            background-color: #2980b9;
        }

        .add-btn:active {
            transform: scale(0.98);
        }

        .task-section {
            margin-bottom: 40px;
        }

        .task-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .task-list {
            list-style: none;
            min-height: 50px;
        }

        .task-item {
            background-color: #fff;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            transition: opacity 0.3s ease, transform 0.3s ease;
            cursor: move;
            user-select: none;
            position: relative;
        }

        .task-item.dragging {
            opacity: 0.5;
            transform: scale(1.02);
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }

        .task-item.completed {
            opacity: 0.6;
            transform: scale(0.98);
        }

        .task-item.completed .task-text {
            text-decoration: line-through;
            color: #7f8c8d;
        }

        .checkbox {
            margin-right: 15px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .task-text {
            flex-grow: 1;
            margin-right: 15px;
            word-break: break-word;
        }

        .task-text[contenteditable="true"] {
            border: 1px solid #3498db;
            padding: 5px;
            border-radius: 4px;
            background-color: #f8f9fa;
        }

        .edit-btn, .delete-btn, .save-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            font-size: 1.1em;
            transition: color 0.3s ease, transform 0.1s ease;
        }

        .edit-btn {
            color: #3498db;
            margin-right: 10px;
        }

        .edit-btn:hover {
            color: #2980b9;
            transform: scale(1.1);
        }

        .save-btn {
            color: #2ecc71;
            margin-right: 10px;
        }

        .save-btn:hover {
            color: #27ae60;
            transform: scale(1.1);
        }

        .delete-btn {
            color: #e74c3c;
        }

        .delete-btn:hover {
            color: #c0392b;
            transform: scale(1.1);
        }

        .drop-zone {
            transition: background-color 0.2s ease;
        }

        .drop-zone.dragover {
            background-color: #e8f4fd;
        }

        @media (max-width: 768px) {
            .task-form {
                padding: 15px;
            }

            .task-input {
                width: 100%;
                margin-bottom: 10px;
            }

            .add-btn {
                width: 100%;
            }

            .task-item {
                flex-wrap: wrap;
                padding: 10px;
            }

            .task-text {
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <h1>Task Manager</h1>
    
    <div class="task-form">
        <input type="text" class="task-input" id="taskInput" placeholder="Enter a new task">
        <button class="add-btn" onclick="addTask()">Add Task</button>
    </div>

    <div class="task-section">
        <h2>Pending Tasks</h2>
        <ul class="task-list drop-zone" id="pendingTasks"></ul>
    </div>

    <div class="task-section">
        <h2>Completed Tasks</h2>
        <ul class="task-list drop-zone" id="completedTasks"></ul>
    </div>

    <script>
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        let draggedItem = null;
        let draggedIndex = null;

        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
            renderTasks();
        }

        function renderTasks() {
            const pendingTasks = document.getElementById('pendingTasks');
            const completedTasks = document.getElementById('completedTasks');
            pendingTasks.innerHTML = '';
            completedTasks.innerHTML = '';

            tasks.forEach((task, index) => {
                const taskItem = document.createElement('li');
                taskItem.className = `task-item ${task.completed ? 'completed' : ''}`;
                taskItem.setAttribute('draggable', 'true');
                taskItem.setAttribute('data-index', index);
                
                taskItem.innerHTML = `
                    <input type="checkbox" class="checkbox" 
                        ${task.completed ? 'checked' : ''} 
                        onchange="toggleTask(${index})">
                    <span class="task-text" contenteditable="false">${task.text}</span>
                    <button class="edit-btn" onclick="startEditing(${index})" 
                        style="${task.completed ? 'display: none' : ''}">‚úèÔ∏è</button>
                    <button class="save-btn" onclick="saveEdit(${index})" style="display: none">üíæ</button>
                    <button class="delete-btn" onclick="deleteTask(${index})">üóëÔ∏è</button>
                `;

                if (task.completed) {
                    completedTasks.appendChild(taskItem);
                } else {
                    pendingTasks.appendChild(taskItem);
                }

                // Add drag events
                taskItem.addEventListener('dragstart', handleDragStart);
                taskItem.addEventListener('dragend', handleDragEnd);
            });

            // Add drop zone events
            [pendingTasks, completedTasks].forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragenter', handleDragEnter);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });
        }

        function addTask() {
            const input = document.getElementById('taskInput');
            const text = input.value.trim();
            
            if (text) {
                tasks.push({
                    text: text,
                    completed: false
                });
                input.value = '';
                saveTasks();
            }
        }

        function toggleTask(index) {
            tasks[index].completed = !tasks[index].completed;
            saveTasks();
        }

        function startEditing(index) {
            if (!tasks[index].completed) {
                const taskItem = document.querySelector(`[data-index="${index}"]`);
                const taskText = taskItem.querySelector('.task-text');
                const editBtn = taskItem.querySelector('.edit-btn');
                const saveBtn = taskItem.querySelector('.save-btn');

                taskText.setAttribute('contenteditable', 'true');
                taskText.focus();
                editBtn.style.display = 'none';
                saveBtn.style.display = 'inline-block';

                // Prevent dragging while editing
                taskItem.setAttribute('draggable', 'false');
            }
        }

        function saveEdit(index) {
            const taskItem = document.querySelector(`[data-index="${index}"]`);
            const taskText = taskItem.querySelector('.task-text');
            const editBtn = taskItem.querySelector('.edit-btn');
            const saveBtn = taskItem.querySelector('.save-btn');
            const newText = taskText.textContent.trim();

            if (newText) {
                tasks[index].text = newText;
                taskText.setAttribute('contenteditable', 'false');
                editBtn.style.display = 'inline-block';
                saveBtn.style.display = 'none';
                taskItem.setAttribute('draggable', 'true');
                saveTasks();
            }
        }

        function deleteTask(index) {
            tasks.splice(index, 1);
            saveTasks();
        }

        // Drag and Drop Handlers
        function handleDragStart(e) {
            draggedItem = this;
            draggedIndex = parseInt(this.getAttribute('data-index'));
            setTimeout(() => this.classList.add('dragging'), 0);
        }

        function handleDragEnd() {
            this.classList.remove('dragging');
            draggedItem = null;
            draggedIndex = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDragEnter(e) {
            e.preventDefault();
            this.classList.add('dragover');
        }

        function handleDragLeave() {
            this.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            this.classList.remove('dragover');
            
            const dropZone = this;
            const isCompletedZone = dropZone.id === 'completedTasks';
            const droppedTask = tasks[draggedIndex];
            
            // Remove task from original position
            tasks.splice(draggedIndex, 1);
            
            // Update completion status based on drop zone
            droppedTask.completed = isCompletedZone;
            
            // Find new position
            const items = dropZone.querySelectorAll('.task-item:not(.dragging)');
            let newIndex = 0;
            
            if (items.length > 0) {
                const rect = dropZone.getBoundingClientRect();
                const dropY = e.clientY - rect.top;
                let inserted = false;
                
                for (let i = 0; i < items.length; i++) {
                    const itemRect = items[i].getBoundingClientRect();
                    const itemTop = itemRect.top - rect.top;
                    const itemBottom = itemTop + itemRect.height;
                    
                    if (dropY < itemBottom) {
                        newIndex = tasks.indexOf(tasks.find(t => 
                            t.text === items[i].querySelector('.task-text').textContent));
                        tasks.splice(newIndex, 0, droppedTask);
                        inserted = true;
                        break;
                    }
                }
                
                if (!inserted) {
                    newIndex = tasks.indexOf(tasks.find(t => 
                        t.text === items[items.length - 1].querySelector('.task-text').textContent)) + 1;
                    tasks.splice(newIndex, 0, droppedTask);
                }
            } else {
                tasks.push(droppedTask);
            }
            
            saveTasks();
        }

        // Add task with Enter key
        document.getElementById('taskInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addTask();
            }
        });

        // Initial render
        renderTasks();
    </script>
</body>
</html>
